<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ClarifyJS - Demos</title>

  <link rel="stylesheet" href="./styles.css">
  <!-- Tailwind CSS desde CDN -->
  <script src="https://cdn.tailwindcss.com"></script>


  <script type="module">
    import { customComponentsExample } from "./custom-components-example.ts";
    import {
      addressFormExample,
      customValidationExample,
      masksExample,
      productFormExample,
      registrationFormExample,
      userProfileExample,
    } from "./examples.ts";


    // ==================== INICIALIZAR COMPONENTES GLOBALES ====================
    // Esto se ejecuta UNA VEZ al inicio de la aplicaci贸n
    console.log(" Componentes globales inicializados para toda la aplicaci贸n");

    const demos = {
      registration: {
        title: "Formulario de Registro",
        description: "Schema Zod completo con validaciones complejas y confirmaci贸n de contrase帽a",
        fn: registrationFormExample,
      },
      address: {
        title: "Formulario de Direcci贸n",
        description: "Objetos anidados y validaciones de c贸digo postal",
        fn: addressFormExample,
      },
      product: {
        title: "Formulario de Producto",
        description: "Campos opcionales, select con enum y checkbox",
        fn: productFormExample,
      },
      profile: {
        title: "Perfil de Usuario",
        description: "Validaciones regex, objetos anidados m煤ltiples",
        fn: userProfileExample,
      },
      custom: {
        title: "Validaciones Personalizadas",
        description: "Expresiones regulares complejas y reglas de contrase帽a",
        fn: customValidationExample,
      },
      masks: {
        title: "M谩scaras de Entrada",
        description: "M谩scaras de formato y regex, password con toggle",
        fn: masksExample,
      },
      components: {
        title: "Componentes Personalizados",
        description: "Toggle switch y checkbox estilizados con HTML personalizado (config local)",
        fn: customComponentsExample,
      },

    };

    let currentDemo = null;
    let submitButton = null;

    function loadDemo(demoKey) {
      const demo = demos[demoKey];
      if (!demo) return;

      // Actualizar botones activos
      document.querySelectorAll(".demo-button").forEach((btn) => {
        btn.classList.toggle("active", btn.dataset.demo === demoKey);
      });

      // Limpiar contenedor
      const container = document.getElementById("root");
      container.innerHTML = "";

      // Mostrar info
      const infoBox = document.createElement("div");
      infoBox.className = "info-box";
      infoBox.innerHTML = `
        <h3>${demo.title}</h3>
        <p>${demo.description}</p>
      `;
      container.appendChild(infoBox);

      // Renderizar formulario
      const form = demo.fn();
      container.appendChild(form.render());

      // Crear y a帽adir bot贸n de submit
      submitButton = document.createElement("button");
      submitButton.type = "submit";
      submitButton.disabled = true; // Inicialmente deshabilitado
      submitButton.className = "clarifyjs-submit bg-blue-500 text-white px-6 py-3 border-none rounded-md text-base font-semibold cursor-pointer transition-all w-full mt-2.5 hover:bg-blue-600 hover:-translate-y-px hover:shadow-[0_4px_12px_rgba(59,130,246,0.3)] active:translate-y-0 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none";
      submitButton.textContent = "Submit";

      // A帽adir el bot贸n al formulario
      const formElement = container.querySelector("form");
      if (formElement) {
        formElement.appendChild(submitButton);
      }

      currentDemo = form;
    }

    // Funci贸n para actualizar el estado del bot贸n (llamada por onValidate)
    window.updateSubmitButton = (isValid) => {
      if (submitButton) {
        submitButton.disabled = !isValid;
      }
    };

    // Inicializar
    window.addEventListener("DOMContentLoaded", () => {
      // Crear botones
      const selector = document.getElementById("demo-selector");
      Object.entries(demos).forEach(([key, demo]) => {
        const button = document.createElement("button");
        button.className = "demo-button bg-blue-500 text-white rounded-md px-2  m-0.5 hover:bg-blue-600 hover:shadow-[0_4px_12px_rgba(59,130,246,0.3)]";
        button.dataset.demo = key;
        button.textContent = demo.title;
        button.addEventListener("click", () => loadDemo(key));
        selector.appendChild(button);
      });

      // Cargar primer demo
      loadDemo("registration");
    });

    // Exponer para debugging
    window.getCurrentForm = () => currentDemo;
  </script>
</head>

<body>
  <h1> ClarifyJS - Demos Interactivas</h1>
  <p class="subtitle">Generador de formularios con validaci贸n Zod autom谩tica</p>

  <div id="demo-selector" class="demo-selector"></div>

  <div id="root" class="demo-container"></div>
</body>

</html>